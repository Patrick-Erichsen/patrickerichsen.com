---
import Layout from '@layouts/Layout.astro'
import { getSortedPosts } from '@utils'
import { getCollection, render } from 'astro:content'
import PostList from '@components/PostList.astro'
import HomeBanner from '@components/HomeBanner.astro'

const home = await getCollection('home')
let HomeContent
if (home.length > 0) {
  const homeEntry = home[0]
  const { Content } = await render(homeEntry)
  HomeContent = Content
}
const sortedPosts = await getSortedPosts()
---

<Layout>
  {
    HomeContent && (
      <HomeBanner avatarUrl="https://pbs.twimg.com/profile_images/2018201535340228608/ZPW8FN3m_400x400.jpg">
        <HomeContent />
      </HomeBanner>
    )
  }
  {
    sortedPosts.length > 0 && (
      <PostList posts={sortedPosts} />
    )
  }
</Layout>
